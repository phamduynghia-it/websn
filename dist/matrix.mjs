/**
 * Matrix effect on a Canvas https://jcubic.github.io/cmatrix/
 *
 * Copyright (c) 2021-2023 Jakub T. Jankiewicz <https://jcubic.pl/me>
 * Released under MIT license
 *
 * The code was started at this Codepen https://codepen.io/jcubic/pen/rNeNwgB
 * And was based on code by Michael Goodman https://codepen.io/goodmanmr1/pen/jpPeRR
 *
 * Build: Mon, 30 Jun 2025 03:38:18 GMT
 */
var t=a(12449,12534),e=a(12353,12438);class i{constructor(s,{chars:a=null,font_size:r=18,width:o,height:h,font:n="monospace",color:l,background:c}={}){this._canvas=s,this._canvas._matrix&&(this._canvas._matrix.stop(),this._canvas._matrix.clear()),this._canvas._matrix=this,this._ctx=s.getContext("2d"),this._font_size=r,this._drops=[],this._color=l,this._background=c,this._font=n,this._chars=a||t.concat(e),this.resize(o,h),i.messages=["3","2","1","Happy birthday","25.06.2003","Nguyễn Bảo Hân","Chúc em sinh nhật vui vẻ","Có tất cả trừ vất vả"],i.currentMessageIndex=0,i.nextMessageIndex=1,i.ledParticles=[],i.morphing=!1,i.morphProgress=0,i.lastSwitchTime=0,i.showHeart=!1,i.fallingImages=[" a1.jfif","a2.jfif"],i.loadedImages=[],i.fallingState=null}random_char(){return(t=this._chars)[Math.floor(Math.random()*t.length)];var t}render_char(t,e,i){this._ctx.fillText(t,e,i)}start(){if(this._run)return;let t=0;this._run=!0;const e=this;!function i(){e._run&&(t++%2==0&&e.render(),requestAnimationFrame(i))}()}stop(){this._run=!1}reset(){for(let t=0;t<this._columns;t++)this._drops[t]=255}resize(t,e){this._width=t,this._height=e,this.clear(),this._canvas.width=t,setTimeout((()=>{this._canvas.height=e,this.reset()}),0),this._columns=Math.round(t/this._font_size)}clear(){this._ctx.fillStyle=this._background,this._ctx.fillRect(0,0,this._width,this._height),this._ctx.fillStyle=this._color,this._ctx.font=this._font_size+"px "+this._font}fullscreen(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen()}getLedPoints(t,e,i,s,a=8){const r=document.createElement("canvas");r.width=i,r.height=s;const o=r.getContext("2d");o.clearRect(0,0,i,s),o.font=e,o.textAlign="center",o.textBaseline="middle",o.fillStyle="#fff",o.fillText(t,i/2,s/2);const h=o.getImageData(0,0,i,s).data,n=[];for(let t=0;t<s;t+=a)for(let e=0;e<i;e+=a){h[4*(t*i+e)+3]>128&&n.push({x:e,y:t})}return n}render(){this.clear();let t=this._ctx.createLinearGradient(0,0,this._width,0);t.addColorStop(0,"#d291ff"),t.addColorStop(1,"#ff8ae2"),this._ctx.fillStyle=t;for(let t=0;t<this._drops.length;t++){const e=this.random_char(),i=t*this._font_size,s=this._drops[t]*this._font_size;this.render_char(e,i,s),s>this._height&&Math.random()>.975&&(this._drops[t]=0),this._drops[t]++}if(i.showHeart)return void this.renderHeart();const e=this._width,s=this._height,a=`bold ${Math.floor(Math.min(e,s)/7)}px Arial, Roboto, 'sans-serif'`,r=Math.max(3,Math.floor(Math.min(e,s)/70)),o=performance.now(),h=o/500;if(i.morphing){i.morphProgress+=.04;let t=!0;for(let e of i.ledParticles){const s=Math.min(1,i.morphProgress),a=e.x+(e.tx-e.x)*s,o=e.y+(e.ty-e.y)*s;this._ctx.save(),this._ctx.beginPath(),this._ctx.arc(a,o,r/2.5,0,2*Math.PI),this._ctx.fillStyle="#fff";const n=.7+.3*Math.sin(h+e.phase);this._ctx.globalAlpha=(e.alpha*(1-s)+s)*n,this._ctx.shadowColor="#fff",this._ctx.shadowBlur=4,this._ctx.fill(),this._ctx.restore(),s<1&&(t=!1)}if(t){if(i.currentMessageIndex===i.messages.length-1)return void(i.showHeart=!0);i.currentMessageIndex=i.nextMessageIndex,i.nextMessageIndex=(i.nextMessageIndex+1)%i.messages.length,i.morphing=!1,i.lastSwitchTime=o}}else{const t=this.getLedPoints(i.messages[i.currentMessageIndex],a,e,s,r);i.ledParticles=t.map((t=>({x:t.x,y:t.y,tx:t.x,ty:t.y,alpha:1,phase:Math.random()*Math.PI*2})));for(let t of i.ledParticles){this._ctx.save(),this._ctx.beginPath(),this._ctx.arc(t.x,t.y,r/2.5,0,2*Math.PI),this._ctx.fillStyle="#fff";const e=.7+.3*Math.sin(h+t.phase);this._ctx.globalAlpha=t.alpha*e,this._ctx.shadowColor="#fff",this._ctx.shadowBlur=4,this._ctx.fill(),this._ctx.restore()}if(i.currentMessageIndex===i.messages.length-1&&o-i.lastSwitchTime>2e3)return void(i.showHeart=!0);if(o-i.lastSwitchTime>2e3){const o=t,h=this.getLedPoints(i.messages[i.nextMessageIndex],a,e,s,r),n=Math.max(o.length,h.length);i.ledParticles=[];for(let t=0;t<n;t++){const e=o[t%o.length],s=h[t%h.length];i.ledParticles.push({x:e.x,y:e.y,tx:s.x,ty:s.y,alpha:1,phase:Math.random()*Math.PI*2})}i.morphing=!0,i.morphProgress=0}}}renderHeart(){const t=this._ctx,e=this._width,s=this._height,a={length:2e3,duration:2,velocity:100,effect:-1.3,size:13};if(!this._heartParticles){this._heartParticles=[],this._heartParticlePool=[];for(let t=0;t<a.length;t++)this._heartParticlePool.push({position:{x:0,y:0},velocity:{x:0,y:0},acceleration:{x:0,y:0},age:0});this._heartFirstActive=0,this._heartFirstFree=0,this._heartTime=null,this._heartImage=(()=>{const t=document.createElement("canvas"),e=t.getContext("2d");function i(t){const e=function(t){return{x:160*Math.pow(Math.sin(t),3),y:130*Math.cos(t)-50*Math.cos(2*t)-20*Math.cos(3*t)-10*Math.cos(4*t)+25}}(t);return e.x=a.size/2+e.x*a.size/350,e.y=a.size/2-e.y*a.size/350,e}t.width=a.size,t.height=a.size,e.beginPath();let s=-Math.PI,r=i(s);for(e.moveTo(r.x,r.y);s<Math.PI;)s+=.01,r=i(s),e.lineTo(r.x,r.y);e.closePath(),e.fillStyle="#FF5CA4",e.fill();const o=new window.Image;return o.src=t.toDataURL(),o})()}const r=performance.now()/1e3,o=r-(this._heartTime||r);this._heartTime=r;const h=a.length/a.duration*o;for(let t=0;t<h;t++){const t=(n=Math.PI-2*Math.PI*Math.random(),{x:160*Math.pow(Math.sin(n),3),y:130*Math.cos(n)-50*Math.cos(2*n)-20*Math.cos(3*n)-10*Math.cos(4*n)+25}),i=Math.sqrt(t.x*t.x+t.y*t.y),r={x:t.x/i*a.velocity,y:t.y/i*a.velocity},o=this._heartParticlePool[this._heartFirstFree];o.position.x=e/2+t.x,o.position.y=s/2-t.y,o.velocity.x=r.x,o.velocity.y=-r.y,o.acceleration.x=r.x*a.effect,o.acceleration.y=-r.y*a.effect,o.age=0,this._heartFirstFree++,this._heartFirstFree===a.length&&(this._heartFirstFree=0),this._heartFirstActive===this._heartFirstFree&&(this._heartFirstActive++,this._heartFirstActive===a.length&&(this._heartFirstActive=0))}var n;let l;if(this._heartFirstActive<this._heartFirstFree)for(l=this._heartFirstActive;l<this._heartFirstFree;l++){const t=this._heartParticlePool[l];t.position.x+=t.velocity.x*o,t.position.y+=t.velocity.y*o,t.velocity.x+=t.acceleration.x*o,t.velocity.y+=t.acceleration.y*o,t.age+=o}if(this._heartFirstFree<this._heartFirstActive){for(l=this._heartFirstActive;l<a.length;l++){const t=this._heartParticlePool[l];t.position.x+=t.velocity.x*o,t.position.y+=t.velocity.y*o,t.velocity.x+=t.acceleration.x*o,t.velocity.y+=t.acceleration.y*o,t.age+=o}for(l=0;l<this._heartFirstFree;l++){const t=this._heartParticlePool[l];t.position.x+=t.velocity.x*o,t.position.y+=t.velocity.y*o,t.velocity.x+=t.acceleration.x*o,t.velocity.y+=t.acceleration.y*o,t.age+=o}}for(;this._heartParticlePool[this._heartFirstActive].age>=a.duration&&this._heartFirstActive!==this._heartFirstFree;)this._heartFirstActive++,this._heartFirstActive===a.length&&(this._heartFirstActive=0);if(this._heartFirstActive<this._heartFirstFree)for(l=this._heartFirstActive;l<this._heartFirstFree;l++){const e=this._heartParticlePool[l],i=t=>--t*t*t+1,s=a.size*i(e.age/a.duration);t.globalAlpha=1-e.age/a.duration,t.drawImage(this._heartImage,e.position.x-s/2,e.position.y-s/2,s,s)}if(this._heartFirstFree<this._heartFirstActive){for(l=this._heartFirstActive;l<a.length;l++){const e=this._heartParticlePool[l],i=t=>--t*t*t+1,s=a.size*i(e.age/a.duration);t.globalAlpha=1-e.age/a.duration,t.drawImage(this._heartImage,e.position.x-s/2,e.position.y-s/2,s,s)}for(l=0;l<this._heartFirstFree;l++){const e=this._heartParticlePool[l],i=t=>--t*t*t+1,s=a.size*i(e.age/a.duration);t.globalAlpha=1-e.age/a.duration,t.drawImage(this._heartImage,e.position.x-s/2,e.position.y-s/2,s,s)}}if(t.globalAlpha=1,t.save(),t.font=`bold ${Math.floor(s/12)}px Arial, Roboto, 'sans-serif'`,t.textAlign="center",t.textBaseline="middle",t.fillStyle="#fff",t.shadowColor="#ff5ca4",t.shadowBlur=12,t.fillText("Bảo Hân",e/2,s/2),t.restore(),!i.fallingState){i.loadedImages=[];for(let t of i.fallingImages){const e=new window.Image;e.src=t,e.onload=()=>{},i.loadedImages.push(e)}i.fallingState=i.loadedImages.map(((t,i)=>({y:-Math.random()*s,speed:s/2+Math.random()*s/2,x:0===i?.125*e:.875*e,img:t})))}for(let a=0;a<i.fallingState.length;a++){const r=i.fallingState[a],o=i.loadedImages[a];if(!o.complete)continue;const h=e/4,n=o.height*(h/o.width),l=performance.now()/1e3;r._lastTime||(r._lastTime=l);const c=l-r._lastTime;r._lastTime=l,r.y+=r.speed*c,r.y>s&&(r.y=-n),t.save(),t.globalAlpha=1,t.drawImage(o,r.x-h/2,r.y,h,n),t.restore()}}}function s(t,{chars:e=null,font_size:s=14,exit:a=!0,font:h="monospace",width:n=null,height:l=null,resize:c=!0,color:_="#0F0",mount:d=(()=>{}),unmount:f=(()=>{}),background:g="rgba(0, 0,0,0.05)"}={}){const x=new i(t,{font_size:s,chars:e,font:h,color:_,background:g,width:n??r(),height:l??o()});let m;if(c&&(m=()=>x.resize(r(),o()),window.addEventListener("resize",m),screen?.orientation&&screen.orientation.addEventListener("change",m)),t.classList.add("running"),x.start(),d(x),a)return new Promise((e=>{window.addEventListener("keydown",(i=>{var s=i.key.toLowerCase();"q"!==s&&"escape"!==s||(x.stop(),t.classList.remove("running"),m&&(window.removeEventListener("resize",m),screen?.orientation&&screen.orientation.removeEventListener("change",m)),setTimeout((()=>{f(x),e()}),0))}))}))}function a(t,e){for(var i=[],s=t;s<=e;++s)i.push(String.fromCharCode(s));return i}function r(){return window.innerWidth}function o(){return window.innerHeight}s.range=a,s.custom_chars=s.range(48,53).concat(s.range(55,57)).concat(((...t)=>t.map((t=>String.fromCharCode(t))))(9642,9548,169,166,124,122,62,60,58,34,42,43,12450,12454,12456,12458,12459,12461,12465,12467,12469,12471,12473,12475,12477,12479,12484,12486,12490,12491,12492,12493,12495,12498,12507,12510,12511,12512,12513,12514,12516,12520,12521,12522,12527,12540,42890,59703));export{s as default};
//# sourceMappingURL=matrix.mjs.map
